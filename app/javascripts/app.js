if(typeof web3 !== 'undefined') {
  web3 = new Web3(web3.currentProvider);
} else {
  web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
}

var farmshareContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"members","outputs":[{"name":"name","type":"string"},{"name":"reputation","type":"uint256"},{"name":"balance","type":"uint256"},{"name":"isMember","type":"bool"},{"name":"account","type":"address"},{"name":"tasksCompleted","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_description","type":"string"},{"name":"_price","type":"uint256"},{"name":"_quantity","type":"uint256"}],"name":"newProduct","outputs":[{"name":"prodId","type":"uint32"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"getMemberInfo","outputs":[{"name":"name","type":"string"},{"name":"account","type":"address"},{"name":"status","type":"bool"},{"name":"balance","type":"uint256"},{"name":"reputation","type":"uint256"},{"name":"tasks","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newCommunity","type":"address"}],"name":"newCommunity","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newMember","type":"address"},{"name":"_newName","type":"string"}],"name":"acceptMember","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"id","type":"uint256"}],"name":"getProductInfo","outputs":[{"name":"name","type":"string"},{"name":"seller","type":"string"},{"name":"description","type":"string"},{"name":"price","type":"uint256"},{"name":"quantity","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newTreasury","type":"address"}],"name":"newTreasury","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalProducts","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint256"},{"name":"quant","type":"uint256"}],"name":"purchaseProduct","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getParameters","outputs":[{"name":"getTreasury","type":"address"},{"name":"getCommunity","type":"address"},{"name":"getIniMemberTokens","type":"uint256"},{"name":"getIniMemberReputation","type":"uint256"},{"name":"get_tokenName","type":"string"},{"name":"get_communityName","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_payee","type":"address"},{"name":"_payment","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newCommunityTax","type":"int256"},{"name":"_newRewardRate","type":"uint256"},{"name":"_newIniTokens","type":"uint256"},{"name":"_newIniR","type":"uint256"}],"name":"newParameters","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_oldMember","type":"address"}],"name":"kickOutMember","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":false,"name":"_timeStampT","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_member","type":"address"},{"indexed":false,"name":"_alias","type":"string"}],"name":"NewMember","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_exMember","type":"address"},{"indexed":false,"name":"_exAlias","type":"string"}],"name":"OldMember","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"uint256"},{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"description","type":"string"},{"indexed":false,"name":"price","type":"uint256"},{"indexed":false,"name":"quantity","type":"uint256"}],"name":"NewProduct","type":"event"}]);
var taskboardContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"members","outputs":[{"name":"name","type":"string"},{"name":"reputation","type":"uint256"},{"name":"balance","type":"uint256"},{"name":"isMember","type":"bool"},{"name":"account","type":"address"},{"name":"tasksCompleted","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint256"}],"name":"acceptTask","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"taskBoard","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_description","type":"string"},{"name":"_price","type":"uint256"},{"name":"_quantity","type":"uint256"}],"name":"newProduct","outputs":[{"name":"prodId","type":"uint32"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"getMemberInfo","outputs":[{"name":"name","type":"string"},{"name":"account","type":"address"},{"name":"status","type":"bool"},{"name":"balance","type":"uint256"},{"name":"reputation","type":"uint256"},{"name":"tasks","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newCommunity","type":"address"}],"name":"newCommunity","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newMember","type":"address"},{"name":"_newName","type":"string"}],"name":"acceptMember","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"id","type":"uint256"}],"name":"getProductInfo","outputs":[{"name":"name","type":"string"},{"name":"seller","type":"string"},{"name":"description","type":"string"},{"name":"price","type":"uint256"},{"name":"quantity","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newTreasury","type":"address"}],"name":"newTreasury","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalProducts","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint256"},{"name":"quant","type":"uint256"}],"name":"purchaseProduct","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getParameters","outputs":[{"name":"getTreasury","type":"address"},{"name":"getCommunity","type":"address"},{"name":"getIniMemberTokens","type":"uint256"},{"name":"getIniMemberReputation","type":"uint256"},{"name":"get_tokenName","type":"string"},{"name":"get_communityName","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"remove","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_payee","type":"address"},{"name":"_payment","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_description","type":"string"},{"name":"_reward","type":"uint256"}],"name":"newTask","outputs":[{"name":"taskId","type":"uint32"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"cmAddr","type":"address"}],"name":"setCMAddress","outputs":[{"name":"result","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"id","type":"uint256"}],"name":"getTaskInfo","outputs":[{"name":"name","type":"string"},{"name":"description","type":"string"},{"name":"reward","type":"uint256"},{"name":"owner","type":"address"},{"name":"volunteer","type":"address"},{"name":"status","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalTasks","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newCommunityTax","type":"int256"},{"name":"_newRewardRate","type":"uint256"},{"name":"_newIniTokens","type":"uint256"},{"name":"_newIniR","type":"uint256"}],"name":"newParameters","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_oldMember","type":"address"}],"name":"kickOutMember","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint256"}],"name":"completeTask","outputs":[{"name":"status","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"uint256"},{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"description","type":"string"},{"indexed":false,"name":"reward","type":"uint256"}],"name":"NewTask","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_amount","type":"uint256"},{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":false,"name":"_timeStampT","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_member","type":"address"},{"indexed":false,"name":"_alias","type":"string"}],"name":"NewMember","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_exMember","type":"address"},{"indexed":false,"name":"_exAlias","type":"string"}],"name":"OldMember","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"id","type":"uint256"},{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"description","type":"string"},{"indexed":false,"name":"price","type":"uint256"},{"indexed":false,"name":"quantity","type":"uint256"}],"name":"NewProduct","type":"event"}]);

// var farmshareContract = FarmShare;
// var taskboardContract = TaskBoard;
// var farmshare = farmshareContract.new({data: '0x1234', from: '0x1aac18a98f63f7ccd92ad9e738b6da3487763266', gas: 1000000})
// var taskboard = taskboardContract.new({data: '0x1234', from: '0x1aac18a98f63f7ccd92ad9e738b6da3487763266', gas: 1000000})
console.log("Team Jugaad rocks", farmshare, taskboard);

var farmshareAddr = "0xd7f9d49eeff390658af503f89035fd9b700b735d";
var taskboardAddr = "0x8f26c0952114bac1b908b3cd7f97631a92d5db03";

var farmshare = farmshareContract.at(farmshareAddr);
var taskboard = taskboardContract.at(taskboardAddr);

console.log(farmshare, taskboard);

web3.eth.defaultAccount = web3.eth.coinbase;

var coinbase = web3.eth.coinbase;

var myWallet = farmshare.getMemberInfo(coinbase);
var myName = myWallet[0];
var myAccount = myWallet[1];
var myMembership = myWallet[2];
var myBalance = myWallet[3];
var myReputation = myWallet[4];
var myPastTasks = myWallet[5];

var communityInfo = farmshare.getParameters();
var treasuryAddr = communityInfo[0];
var communityAddr = communityInfo[1];
var initialTokens = communityInfo[2];
var initialRep = communityInfo[3];
var tokenName = communityInfo[4];
var communityName = communityInfo[5];

var numTasks = taskboard.totalTasks();

if (myMembership == true) {
	var member ="Member of " +  communityName + " Community";
} else {
  member ="Not a Member";
	myName = "visitor";
};
